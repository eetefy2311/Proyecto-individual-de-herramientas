theme_minimal(base_size = 13) +
theme(
panel.grid = element_blank(),
plot.title = element_text(hjust = 0.2, face = "bold", size = 11),
plot.subtitle = element_text(hjust = 0.5, color = "gray30", size = 12),
axis.title = element_text(face = "bold"),
legend.position = "right",
legend.title = element_text(face = "bold", size = 11),
legend.text = element_text(size = 10)
)
library(tidymodels)
library(glmnet)
set.seed(123)
datos <- base.filtrada %>%
mutate(Lat.abs = abs(Latitude_Degrees)) %>%
select(Percent_Bleaching, SSTA_Maximum, Cyclone_Frequency, Lat.abs, Date_Year) %>%
drop_na()
rec <- recipe(Percent_Bleaching ~ SSTA_Maximum + Cyclone_Frequency + Lat.abs + Date_Year, data = datos) %>%
step_sqrt(all_outcomes()) %>%
step_normalize(all_predictors())
mod.spec <- linear_reg(penalty = tune(), mixture = 1) %>%
set_engine("glmnet")
wf <- workflow() %>%
add_model(mod.spec) %>%
add_recipe(rec)
folds <- vfold_cv(datos, v = 5)
grid <- grid_regular(penalty(), levels = 10)
tune.res <- tune_grid(wf, resamples = folds, grid = grid, metrics = metric_set(rmse, rsq))
best <- select_best(tune.res, metric = "rmse")
final.wf <- finalize_workflow(wf, best)
final.fit <- fit(final.wf, data = datos)
preds <- predict(final.fit, datos) %>%
bind_cols(datos %>% select(Percent_Bleaching)) %>%
mutate(.pred.bt = (.pred)^2)
library(tidymodels)
library(glmnet)
library(ggplot2)
set.seed(123)
datos <- base.filtrada %>%
mutate(Lat.abs = abs(Latitude_Degrees)) %>%
select(Percent_Bleaching, SSTA_Maximum, Cyclone_Frequency, Lat.abs, Date_Year) %>%
drop_na()
rec <- recipe(Percent_Bleaching ~ SSTA_Maximum + Cyclone_Frequency + Lat.abs + Date_Year, data = datos) %>%
step_sqrt(all_outcomes(), skip = TRUE) %>%
step_normalize(all_predictors())
mod.spec <- linear_reg(penalty = tune(), mixture = 1) %>%
set_engine("glmnet")
wf <- workflow() %>%
add_model(mod.spec) %>%
add_recipe(rec)
folds <- vfold_cv(datos, v = 5)
grid <- grid_regular(penalty(), levels = 10)
tune.res <- tune_grid(wf, resamples = folds, grid = grid, metrics = metric_set(rmse, rsq))
best <- select_best(tune.res, metric = "rmse")
final.wf <- finalize_workflow(wf, best)
final.fit <- fit(final.wf, data = datos)
preds <- predict(final.fit, datos) %>%
bind_cols(datos %>% select(Percent_Bleaching)) %>%
mutate(.pred.bt = (.pred)^2)
metrics(preds, truth = Percent_Bleaching, estimate = .pred.bt)
ggplot(preds, aes(x = Percent_Bleaching, y = .pred.bt)) +
geom_point(aes(color = .pred.bt - Percent_Bleaching), size = 2, alpha = 0.8) +
geom_abline(slope = 1, intercept = 0, linetype = "dashed", color = "gray40", linewidth = 1) +
scale_color_viridis_c(option = "magma", direction = -1, name = "Error de predicción (%)") +
coord_equal(xlim = c(0, 100), ylim = c(0, 100), expand = FALSE) +
labs(title = "Desempeño del modelo con transformación raíz cuadrada", x = "Observado (%)", y = "Predicho (%)") +
theme_minimal(base_size = 13) +
theme(panel.grid = element_blank(), plot.title = element_text(hjust = 0.5, face = "bold"))
install.packages(ranger)
library(ranger)
install.packages(ranger)
install.packages("ranger")
library(ranger)
set.seed(123)
datos <- base.filtrada %>%
mutate(Lat.abs = abs(Latitude_Degrees)) %>%
select(Percent_Bleaching, SSTA_Maximum, Cyclone_Frequency, Lat.abs, Date_Year) %>%
drop_na()
n <- nrow(datos)
idx <- sample(seq_len(n), size = floor(0.8 * n))
train <- datos[idx, ]
test  <- datos[-idx, ]
rf.mod <- ranger(
Percent_Bleaching ~ SSTA_Maximum + Cyclone_Frequency + Lat.abs + Date_Year,
data = train,
num.trees = 600,
mtry = 3,
min.node.size = 5,
importance = "permutation",
seed = 123
)
pred.test <- predict(rf.mod, data = test)$predictions
rmse <- sqrt(mean((pred.test - test$Percent_Bleaching)^2))
r2   <- cor(pred.test, test$Percent_Bleaching)^2
c(RMSE = rmse, R2 = r2)
ggplot(data.frame(obs = test$Percent_Bleaching, pred = pred.test),
aes(x = obs, y = pred)) +
geom_point(aes(color = pred - obs), size = 2, alpha = 0.8) +
geom_abline(slope = 1, intercept = 0, linetype = "dashed", color = "gray40", linewidth = 1) +
scale_color_viridis_c(option = "magma", direction = -1, name = "Error") +
coord_equal(xlim = c(0, 100), ylim = c(0, 100), expand = FALSE) +
labs(title = "Predicho vs observado (Random Forest)",
x = "Observado (%)", y = "Predicho (%)") +
theme_minimal(base_size = 13) +
theme(panel.grid = element_blank(),
plot.title = element_text(hjust = 0.5, face = "bold"))
ggplot(data.frame(obs = test$Percent_Bleaching, pred = pred.test),
aes(x = obs, y = pred)) +
geom_point(aes(color = pred - obs), size = 2, alpha = 0.8) +
geom_abline(slope = 1, intercept = 0, linetype = "dashed", color = "gray40", linewidth = 1) +
scale_color_viridis_c(option = "magma", direction = -1, name = "Error") +
coord_equal(xlim = c(0, 100), ylim = c(0, 100), expand = FALSE) +
labs(title = "Predicho vs observado (Random Forest)",
x = "Observado (%)", y = "Predicho (%)") +
theme_minimal(base_size = 13)
ggplot(data.frame(obs = test$Percent_Bleaching, pred = pred.test),
aes(x = obs, y = pred)) +
geom_point(aes(color = pred - obs), size = 2, alpha = 0.8) +
geom_abline(slope = 1, intercept = 0, linetype = "dashed", color = "red", linewidth = 1) +
scale_color_viridis_c(option = "magma", direction = -1, name = "Error") +
coord_equal(xlim = c(0, 100), ylim = c(0, 100), expand = FALSE) +
labs(title = "Predicho vs observado (Random Forest)",
x = "Observado (%)", y = "Predicho (%)") +
theme_minimal(base_size = 13)
ggplot(data.frame(obs = test$Percent_Bleaching, pred = pred.test),
aes(x = obs, y = pred)) +
geom_point(aes(color = pred - obs), size = 2, alpha = 0.8) +
geom_abline(slope = 1, intercept = 0, linetype = "dashed", color = "blue", linewidth = 1) +
scale_color_viridis_c(option = "magma", direction = -1, name = "Error") +
coord_equal(xlim = c(0, 100), ylim = c(0, 100), expand = FALSE) +
labs(title = "Predicho vs observado (Random Forest)",
x = "Observado (%)", y = "Predicho (%)") +
theme_minimal(base_size = 13)
ggplot(data.frame(obs = test$Percent_Bleaching, pred = pred.test),
aes(x = obs, y = pred)) +
geom_point(aes(color = pred - obs), size = 2, alpha = 0.8) +
geom_abline(slope = 1, intercept = 0, linetype = "dashed", color = "black", linewidth = 1) +
scale_color_viridis_c(option = "magma", direction = -1, name = "Error") +
coord_equal(xlim = c(0, 100), ylim = c(0, 100), expand = FALSE) +
labs(title = "Predicho vs observado (Random Forest)",
x = "Observado (%)", y = "Predicho (%)") +
theme_minimal(base_size = 13)
library(ranger)
set.seed(123)
datos <- base.filtrada %>%
mutate(Lat.abs = abs(Latitude_Degrees)) %>%
select(Percent_Bleaching, SSTA_Maximum, Cyclone_Frequency, Lat.abs, Date_Year) %>%
drop_na()
n <- nrow(datos)
idx <- sample(seq_len(n), size = floor(0.8 * n))
train <- datos[idx, ]
test  <- datos[-idx, ]
rf.mod <- ranger(
Percent_Bleaching ~ SSTA_Maximum + Cyclone_Frequency + Lat.abs + Date_Year,
data = train,
num.trees = 600,
mtry = 3,
min.node.size = 5,
importance = "permutation",
seed = 123
)
pred.test <- predict(rf.mod, data = test)$predictions
rmse <- sqrt(mean((pred.test - test$Percent_Bleaching)^2))
r2   <- cor(pred.test, test$Percent_Bleaching)^2
c(RMSE = rmse, R2 = r2)
ggplot(data.frame(obs = test$Percent_Bleaching, pred = pred.test),
aes(x = obs, y = pred)) +
geom_point(aes(color = pred - obs), size = 2, alpha = 0.8) +
geom_abline(slope = 1, intercept = 0, linetype = "dashed", color = "black", linewidth = 1) +
scale_color_viridis_c(option = "magma", direction = -1, name = "Error") +
coord_equal(xlim = c(0, 100), ylim = c(0, 100), expand = FALSE) +
labs(title = "Predicho vs observado (Random Forest)",
x = "Observado (%)", y = "Predicho (%)") +
theme_minimal(base_size = 13)
ggplot(data.frame(obs = test$Percent_Bleaching, pred = pred.test),
aes(x = obs, y = pred)) +
geom_point(aes(color = pred - obs), size = 2, alpha = 0.8) +
geom_abline(slope = 1, intercept = 0, color = "black", linewidth = 1) +
scale_color_viridis_c(option = "magma", direction = -1, name = "Error") +
coord_equal(xlim = c(0, 100), ylim = c(0, 100), expand = FALSE) +
labs(title = "Predicho vs observado (Random Forest)",
x = "Observado (%)", y = "Predicho (%)") +
theme_minimal(base_size = 13)
ggplot(data.frame(obs = test$Percent_Bleaching, pred = pred.test),
aes(x = obs, y = pred)) +
geom_point(aes(color = pred - obs), size = 2, alpha = 0.8) +
geom_abline(slope = 1, intercept = 0, color = "black", linewidth = 2) +
scale_color_viridis_c(option = "magma", direction = -1, name = "Error") +
coord_equal(xlim = c(0, 100), ylim = c(0, 100), expand = FALSE) +
labs(title = "Predicho vs observado (Random Forest)",
x = "Observado (%)", y = "Predicho (%)") +
theme_minimal(base_size = 13)
ggplot(data.frame(obs = test$Percent_Bleaching, pred = pred.test),
aes(x = obs, y = pred)) +
geom_point(aes(color = pred - obs), size = 2, alpha = 0.8) +
geom_abline(slope = 1, intercept = 0, color = "blue", linewidth = 2) +
scale_color_viridis_c(option = "magma", direction = -1, name = "Error") +
coord_equal(xlim = c(0, 100), ylim = c(0, 100), expand = FALSE) +
labs(title = "Predicho vs observado (Random Forest)",
x = "Observado (%)", y = "Predicho (%)") +
theme_minimal(base_size = 13)
library(ranger)
set.seed(123)
datos <- base.filtrada %>%
mutate(Lat.abs = abs(Latitude_Degrees)) %>%
select(Percent_Bleaching, SSTA_Maximum, Cyclone_Frequency, Lat.abs, Date_Year) %>%
drop_na()
n <- nrow(datos)
idx <- sample(seq_len(n), size = floor(0.8 * n))
train <- datos[idx, ]
test  <- datos[-idx, ]
rf.mod <- ranger(
Percent_Bleaching ~ SSTA_Maximum + Cyclone_Frequency + Lat.abs + Date_Year,
data = train,
num.trees = 600,
mtry = 3,
min.node.size = 5,
importance = "permutation",
seed = 123
)
pred.test <- predict(rf.mod, data = test)$predictions
rmse <- sqrt(mean((pred.test - test$Percent_Bleaching)^2))
r2   <- cor(pred.test, test$Percent_Bleaching)^2
c(RMSE = rmse, R2 = r2)
ggplot(data.frame(obs = test$Percent_Bleaching, pred = pred.test),
aes(x = obs, y = pred)) +
geom_point(aes(color = pred - obs), size = 2, alpha = 0.8) +
geom_abline(slope = 1, intercept = 0, color = "blue", linewidth = 2) +
scale_color_viridis_c(option = "magma", direction = -1, name = "Error") +
coord_equal(xlim = c(0, 100), ylim = c(0, 100), expand = FALSE) +
labs(title = "Predicho vs observado (Random Forest)",
x = "Observado (%)", y = "Predicho (%)") +
theme_minimal(base_size = 13)
library(readr)
library(dplyr)
library(ggplot2)
url <- "https://raw.githubusercontent.com/eetefy2311/Data-proyecto-individual/refs/heads/main/global_bleaching_environmental%20(1).csv"
temp.file <- tempfile(fileext = ".csv")
download.file(url, destfile = temp.file, mode = "wb")
database <- read_csv(temp.file)
View(database)
base.filtrada <- database %>%
select(
Site_ID,
Latitude_Degrees,
Longitude_Degrees,
Ocean_Name,
Ecoregion_Name,
Realm_Name,
Exposure,
Distance_to_Shore,
Date_Year,
Temperature_Mean,
SSTA_Maximum,
TSA_Mean,
Turbidity,
Cyclone_Frequency,
Percent_Bleaching
) %>%
filter(Ocean_Name == "Atlantic", Date_Year >= 2000, Date_Year <= 2020)
base.filtrada <- base.filtrada %>%
mutate(across(
.cols = c(
"Percent_Bleaching",
"Distance_to_Shore",
"Temperature_Mean",
"SSTA_Maximum",
"TSA_Mean"
),
.fns = ~ as.numeric(gsub("[^0-9\\.-]", "", .x))
))
View(base.filtrada)
# Manejo de datos faltantes y outliers.
mediana.dist <- median(base.filtrada$Distance_to_Shore, na.rm = TRUE)
mediana.blanq <- median(base.filtrada$Percent_Bleaching, na.rm = TRUE)
base.filtrada %>%
mutate(
Distance_to_Shore = if_else(is.na(Distance_to_Shore), mediana.dist, Distance_to_Shore),
Percent_Bleaching = if_else(is.na(Percent_Bleaching), mediana.blanq, Percent_Bleaching),
Exposure = if_else(is.na(Exposure), "Desconocido", Exposure)
)
base.filtrada %>%
mutate(
Q1 = quantile(Distance_to_Shore, 0.25, na.rm = TRUE),
Q3 = quantile(Distance_to_Shore, 0.75, na.rm = TRUE),
IQR_val = Q3 - Q1,
lim.inf = Q1 - 1.5 * IQR_val,
lim.sup = Q3 + 1.5 * IQR_val,
Distance_to_Shore = if_else(Distance_to_Shore < lim.inf | Distance_to_Shore > lim.sup,
mediana.dist, Distance_to_Shore)
)
promedio.anual <- base.filtrada %>%
group_by(Date_Year) %>%
summarise(prom.blanq = mean(Percent_Bleaching, na.rm = TRUE))
promedio.anual %>%
ggplot(aes(x = Date_Year, y = prom.blanq)) +
geom_line(color = "#0077B6", size = 1.2) +
geom_point(color = "#00B4D8", size = 2) +
geom_smooth(method = "loess", se = FALSE, color = "#FF6B6B", linetype = "dashed") +
scale_x_continuous(breaks = seq(2000, 2020, by = 2)) +
labs(
title = "Tendencia del blanqueamiento coralino en el Océano Atlántico (2000–2020)",
x = "Año",
y = "Porcentaje promedio de blanqueamiento (%)"
) +
theme_minimal() +
theme(
plot.title = element_text(hjust = 0.5, size = 10.3, face = "bold"),
plot.margin = margin(t = 20, r = 20, b = 20, l = 20)
)
library(RColorBrewer)
top.ecoreg <- base.filtrada %>%
filter(!is.na(Ecoregion_Name)) %>%
group_by(Ecoregion_Name) %>%
filter(n()>30) %>%
summarise(prom.blanq = mean(Percent_Bleaching, na.rm = TRUE)) %>%
arrange(desc(prom.blanq)) %>%
mutate(Ecoregion_Name = factor(Ecoregion_Name, levels = Ecoregion_Name))
cols <- rev(colorRampPalette(c("#4292C6", "#08306B"))(nrow(top.ecoreg)))
top.ecoreg %>%
ggplot(aes(x = Ecoregion_Name, y = prom.blanq, fill = Ecoregion_Name)) +
geom_bar(stat = "identity", show.legend = TRUE, width = 0.7) +
scale_fill_manual(values = cols) +
labs(
title = "Promedio de blanqueamiento coralino por ecorregión (2000–2020)",
x = "Porcentaje promedio de blanqueamiento (%)",
y = "Ecorregión"
) +
theme_minimal() +
theme(axis.text.x = element_blank())
#Exposición de los arrecifes
exposicion.pastel <- base.filtrada %>%
filter(!is.na(Exposure)) %>%
group_by(Exposure) %>%
summarise(cantidad = n()) %>%
mutate(porcentaje.pastel = round((cantidad / sum(cantidad)) * 100, 1))
exposicion.pastel %>%
ggplot(aes(x = "", y = porcentaje.pastel, fill = Exposure)) +
geom_bar(stat = "identity", width = 1, color = "white") +
coord_polar(theta = "y") +
geom_text(aes(label = paste0(porcentaje.pastel, "%")),
position = position_stack(vjust = 0.5),
color = "black",
size = 4) +
scale_fill_brewer(palette = "Pastel1") +
labs(
title = "Distribución de registros por tipo de exposición (2000–2020)",
fill = "Tipo de exposición"
) +
theme_void()
library(RColorBrewer)
top.ecoreg <- base.filtrada %>%
filter(!is.na(Ecoregion_Name)) %>%
group_by(Ecoregion_Name) %>%
filter(n()>30) %>%
summarise(prom.blanq = mean(Percent_Bleaching, na.rm = TRUE)) %>%
arrange(desc(prom.blanq)) %>%
mutate(Ecoregion_Name = factor(Ecoregion_Name, levels = Ecoregion_Name))
cols <- rev(colorRampPalette(c("#4292C6", "#08306B"))(nrow(top.ecoreg)))
top.ecoreg %>%
ggplot(aes(x = Ecoregion_Name, y = prom.blanq, fill = Ecoregion_Name)) +
geom_bar(stat = "identity", show.legend = TRUE, width = 0.7) +
scale_fill_manual(values = cols) +
labs(
title = "Promedio de blanqueamiento coralino por ecorregión (2000–2020)",
x = "Porcentaje promedio de blanqueamiento (%)",
y = "Ecorregión"
) +
theme_minimal() +
theme(axis.text.x = element_blank())
exposicion.pastel <- base.filtrada %>%
filter(!is.na(Exposure)) %>%
group_by(Exposure) %>%
summarise(cantidad = n()) %>%
mutate(porcentaje.pastel = round((cantidad / sum(cantidad)) * 100, 1))
exposicion.pastel %>%
ggplot(aes(x = "", y = porcentaje.pastel, fill = Exposure)) +
geom_bar(stat = "identity", width = 1, color = "white") +
coord_polar(theta = "y") +
geom_text(aes(label = paste0(porcentaje.pastel, "%")),
position = position_stack(vjust = 0.5),
color = "black",
size = 4) +
scale_fill_brewer(palette = "Pastel1") +
labs(
title = "Distribución de registros por tipo de exposición (2000–2020)",
fill = "Tipo de exposición"
) +
theme_void()
exposicion.pastel <- base.filtrada %>%
filter(!is.na(Exposure)) %>%
group_by(Exposure) %>%
summarise(cantidad = n()) %>%
mutate(porcentaje.pastel = round((cantidad / sum(cantidad)) * 100, 1))
exposicion.pastel %>%
ggplot(aes(x = "", y = porcentaje.pastel, fill = Exposure)) +
geom_bar(stat = "identity", width = 1, color = "white") +
coord_polar(theta = "y") +
geom_text(aes(label = paste0(porcentaje.pastel, "%")),
position = position_stack(vjust = 0.5),
color = "black",
size = 4) +
scale_fill_brewer(palette = "Pastel1") +
labs(
title = "Distribución de registros por tipo de exposición (2000–2020)",
fill = "Tipo de exposición"
) +
theme_void()
mediana.dist <- median(base.filtrada$Distance_to_Shore, na.rm = TRUE)
base.filtrada <- base.filtrada %>%
mutate(
Distance_to_Shore = ifelse(is.na(Distance_to_Shore), mediana.dist, Distance_to_Shore),
Distancia.categoria = case_when(
Distance_to_Shore <= 1000 ~ "Cercano a la costa (<= 1 km)",
Distance_to_Shore > 1000 & Distance_to_Shore <= 10000 ~ "Intermedio (1–10 km)",
Distance_to_Shore > 10000 ~ "Mar abierto (> 10 km)"
)
)
# Promedio de blanqueamiento por categoria
distancia.blanq <- base.filtrada %>%
group_by(Distancia.categoria) %>%
summarise(prom.blanq = mean(Percent_Bleaching, na.rm = TRUE))
distancia.blanq %>%
ggplot(aes(x = Distancia.categoria, y = prom.blanq, fill = Distancia.categoria)) +
geom_bar(stat = "identity", show.legend = FALSE, width = 0.7) +
labs(
title = "Promedio de blanqueamiento coralino según la distancia a la costa (2000–2020)",
x = "Categoría de distancia a la costa",
y = "Porcentaje promedio de blanqueamiento (%)"
) +
theme_minimal() +
theme(
plot.title = element_text(hjust = 0.5, size = 11),
plot.margin = margin(t = 20, r = 20, b = 20, l = 20)
)
#Temperatura promedio en relación con el blanqueamiento de arrecifes
base.filtrada <- base.filtrada %>%
mutate(temp.cel = Temperature_Mean - 273.15)
base.filtrada %>%
ggplot(aes(x = temp.cel, y = Percent_Bleaching)) +
stat_density_2d(aes(fill = after_stat(level)), geom = "polygon", alpha = 0.9, color = NA) +
scale_fill_viridis_c(option = "magma", direction = -1, name = "Densidad de puntos") +
labs(
title = "Relación entre la temperatura promedio y el blanqueamiento coralino (2000–2020)",
x = "Temperatura promedio (°C)",
y = "Porcentaje de blanqueamiento (%)"
) +
theme_minimal() +
theme(
plot.title = element_text(hjust = 0.2, size = 11),
plot.margin = margin(t = 20, r = 20, b = 20, l = 20)
)
#Anomalías térmicas por región en relación con el blanqueamiento de los arrecifes
library(ggrepel)
ssta.ecoreg <- base.filtrada %>%
group_by(Ecoregion_Name) %>%
summarise(
prom.blanq = mean(Percent_Bleaching, na.rm = TRUE),
max.ssta = mean(SSTA_Maximum, na.rm = TRUE)
) %>%
arrange(desc(max.ssta))
ggplot(ssta.ecoreg, aes(x = max.ssta, y = prom.blanq, label = Ecoregion_Name)) +
geom_point(color = "#E53935", size = 3, alpha = 0.8) +
geom_smooth(method = "lm", se = TRUE, color = "#1E88E5", linewidth = 1) +
ggrepel::geom_text_repel(size = 3, color = "gray20", max.overlaps = 10) +
labs(
title = "Relación entre anomalías térmicas (SSTA máxima) y blanqueamiento por ecorregión",
x = "Anomalía máxima de temperatura superficial (°C)",
y = "Porcentaje promedio de blanqueamiento (%)"
) +
theme_minimal(base_size = 12) +
theme(
plot.title = element_text(hjust = 0.4, size = 10),
plot.subtitle = element_text(hjust = 0.5, size = 9, color = "gray30"),
plot.margin = margin(t = 15, r = 15, b = 15, l = 15)
)
library(ranger)
set.seed(123)
datos <- base.filtrada %>%
mutate(Lat.abs = abs(Latitude_Degrees)) %>%
select(Percent_Bleaching, SSTA_Maximum, Cyclone_Frequency, Lat.abs, Date_Year) %>%
drop_na()
n <- nrow(datos)
idx <- sample(seq_len(n), size = floor(0.8 * n))
train <- datos[idx, ]
test  <- datos[-idx, ]
rf.mod <- ranger(
Percent_Bleaching ~ SSTA_Maximum + Cyclone_Frequency + Lat.abs + Date_Year,
data = train,
num.trees = 600,
mtry = 3,
min.node.size = 5,
importance = "permutation",
seed = 123
)
pred.test <- predict(rf.mod, data = test)$predictions
rmse <- sqrt(mean((pred.test - test$Percent_Bleaching)^2))
r2   <- cor(pred.test, test$Percent_Bleaching)^2
c(RMSE = rmse, R2 = r2)
ggplot(data.frame(obs = test$Percent_Bleaching, pred = pred.test),
aes(x = obs, y = pred)) +
geom_point(aes(color = pred - obs), size = 2, alpha = 0.8) +
geom_abline(slope = 1, intercept = 0, color = "blue", linewidth = 2) +
scale_color_viridis_c(option = "magma", direction = -1, name = "Error") +
coord_equal(xlim = c(0, 100), ylim = c(0, 100), expand = FALSE) +
labs(title = "Predicho vs observado (Random Forest)",
x = "Observado (%)", y = "Predicho (%)") +
theme_minimal(base_size = 13)
setwd("C:/Users/Usuario/OneDrive/Escritorio/Proyecto_arrecifes/Proyecto_individual_C4H522")
setwd("C:/Users/Usuario/OneDrive/Escritorio/Proyecto_arrecifes/Proyecto_individual_C4H522/res")
setwd("C:/Users/Usuario/OneDrive/Escritorio/Proyecto_arrecifes/Proyecto_individual_C4H522")
knitr::include_graphics("res/Blanqueamiento_tiempo.png")
